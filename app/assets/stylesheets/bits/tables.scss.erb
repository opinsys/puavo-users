/*
  Tables
*/

table {
  border-collapse: collapse;
}

th, td {
  vertical-align: middle;
  margin: 0;
  padding: 6px;
}

th {
  font-size: 110%;
  text-align: left;
  text-decoration: none;
}

/* Lists of schools, users, devices, etc. */
.list {
  width: 100%;
  color: $listFore;

  th {
    background: $listHeadingBack;
    color: $listHeadingFore;
    border-top: 1px solid $listHeadingBorder;
    border-left: 1px solid $listHeadingBorder;
    border-bottom: 1px solid $listHeadingBorder;
    padding: 10px;
    font-size: 100%;
  }

  tbody > tr:last-child {
    border-bottom: 1px solid $listHeadingBorder;
  }

  th:first-of-type {
    border-left: none;
  }

  tr {
    &:nth-child(odd) {
      background: $listOddRowBack;
    }

    &:nth-child(even) {
      background: $listEvenRowBack;
    }

    &:hover {
      background: $listRowHoverBack;
    }
  }

  td {
    border-left: 1px solid $listRowBorder;
  }

  td:first-of-type {
    border-left: none;
  }

  .form {
    margin-top: 20px;
    float: left;
  }

  input[type="text"] {
    width: 15em;
  }

  input[type="submit"] {
    paddin: 0;
    margin: 0;
    width: auto;
    height: auto;
    float: right;
  }

  @media #{$screen-breakpoint-one} {
    /* Minimize lists */
    width: 100%;

    .thead, th {
      display: none;
    }

    tbody > tr:last-child {
      border-bottom: none;
    }

    tr {
      display: block;
      padding: 2%;
      border-bottom: 1px solid $listRowBorder;
    }

    td {
      display: block;
      padding: 2px;
      border: none;
    }

    td:first-of-type {
      font-size: 120%;
      padding: 6px 2px;
    }

    td[data-title]:before {
      content: attr(data-title) ":\00A0";
      font-weight: bold;
    }

    .tableActions {
      display: inline-block;

      .btn {
        font-size: 90%;
        padding: 2px 10px;
      }
    }
  }

  .boolean {    /* Boolean column checkmarks */
    text-align: center;
    display: block;
    font-size: 200%;

    @media #{$screen-breakpoint-one} {
      display: inline;
      text-align: left;
      font-size: 100%;
    }
  }
}

/*
----------------------------------------------------------------------------------------------------
SUPERTABLES
----------------------------------------------------------------------------------------------------
*/

#modalDialogBackdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1000;
  display: flex;
  background: rgba(0, 0, 0, 0.3);
  align-items: center;
  justify-content: center;
}

/* Some composable style classes */
.minimize-width { width: 1px; white-space: nowrap; }
.width-0 { width: 0; }
.cursor-not-allowed { cursor: not-allowed !important; }
.cursor-pointer { cursor: pointer; }
.cursor-default { cursor: default; }
.cursor-grabbing { cursor: grabbing; }
.hidden { display: none !important; }
.not-visible { visibility: hidden; }
.margin-left-25 { margin-left: 25px; }
.margin-top-5 { margin-top: 5px; }
.width-100p { width: 100%; }
.nowrap { white-space: nowrap; }
.flex { display: flex; }
.flex-vcenter { align-items: center; }
.no-text-selection { user-select: none; }
.no-pointer-events { pointer-events: none; }
.margin-right-10 { margin-right: 10px; }
.sticky { position: sticky; top: 0; }

.stUserMarkedForDeletion {
  background: $markedForDeletionBackground;
  padding: 2px;
}

.stAdmin {
  color: $adminOwner;
}

/* Wraps the supertable and its controls */
.superTable {
  display: flex;
  flex-direction: column;

  > div {
    margin-bottom: 10px;
  }

  button {
    margin-right: 5px;
    padding: 2px 5px;
    font-family: "Arial", "sans-serif";
    font-size: 100%;
  }

  select {
    font-family: "Arial", "sans-serif";
    font-size: 100%;
    padding: 1px 5px;
  }

  label {
  }

  fieldset legend {
  }

  button:disabled {
    cursor: not-allowed;
  }

  button:hover:disabled {
    cursor: not-allowed;
  }

  /* The supertable tab bar */
  ul.tabs {
    list-style-type: none;
    margin: 0;
    padding: 0;
    display: flex;
    z-index: 2;
  }

  ul.tabs li {
    border: 1px solid $stTabsBorder;
    display: inline;
    padding: 5px 20px;
    border-radius: 3px 3px 0 0;
    margin-right: 2px;
    min-width: 150px;
    text-align: center;
  }

  ul.tabs li.unselected {
    background: $stTabBackground;
    cursor: pointer;
  }

  ul.tabs li.unselected:hover {
    background: $stTabHoverBackground;
  }

  ul.tabs li.selected {
    background: $stTabSelectedBackground;
    cursor: default;
    border-bottom: 1px solid $stTabSelectedBackground;
    font-weight: bold;
  }

  ul.tabs li.disabled {
    color: $stTabDisabledForeground !important;
    cursor: not-allowed !important;
  }

  ul.tabs li.disabled:hover {
    color: $stTabDisabledForeground !important;
    background: $stTabDisabledBackground !important;
    cursor: not-allowed !important;
  }

  /* Tab container DIV */
  .tab {
    z-index: 1;
    margin-top: -1px;
    border: 1px solid $stTabsBorder;
    padding: 10px;
  }

  .tab p {
    margin: 0;
  }

  /* Column editing */
  span.unsavedWarning {
    color: $pceError;   /* eugh */
  }

  .columnTable {
    border: 0;
    margin-top: 5px;
  }

  .columnTable td {
    padding: 0;
    margin: 0;
  }

  .columnTable button {
    width: 100%;
    margin-bottom: 5px;
    margin-left: 5px;
  }

  .columnList {
    display: flex;
    flex-direction: column;
    flex-wrap: nowrap;
    width: 100%;
    max-height: 250px;
    overflow-x: hidden;
    overflow-y: scroll;
    border: 1px solid $stTabsBorder;
  }

  .columnList .column {
    display: flex;
    align-items: center;
    padding: 5px 10px;
    cursor: pointer;
    color: $pageContentFore;
  }

  .columnList .column:hover {
    background: $stColumnListHoverBackground;
    color: $stColumnListHoverForeground;
  }

  .columnList .selected { background: $stColumnListSelected; }
  .columnList .disabled { color: $stColumnListDisabled; cursor: not-allowed; }
  .columnList .selected.disabled { color: $stColumnListDisabled; }
  .columnList .selected:hover { background: $stColumnListSelected; }
  .columnList .disabled:hover { background: none; }
  .columnList .selected.disabled:hover { background: $stColumnListSelected; }

  .columnList .column input {
    pointer-events: none;       /* The checkbox is there just for the looks */
    margin-right: 10px;
  }

  /* Supertable filtering */
  .filters .ui {
    margin-top: 5px;
  }

  .filters .mainButtons {
    margin-bottom: 5px;
  }

  .filters textarea {
    width: 100%;
    margin-bottom: 5px;
    padding: 5px;
  }

  .filters .invalidJSON {
    border: 1px solid $genericErrorBorder;
  }

  .filters .table {
    border-collapse: collapse;
    border: none;
  }

  .filters .table td {
    margin: 0;
    padding: 1px;
    border: none;
  }

  .filters .table tr {
    border-top: 1px solid $stFiltersRowBorder;
    border-bottom: 1px solid $stFiltersRowBorder;
  }

  .filters .table tr:last-of-type {
    border-bottom: none;
  }

  .filters .table div.explanation {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 3px;
    min-width: 250px;
  }

  .filters .table .invalidColumn { background: $stFiltersInvalidColumn; }
  .filters .table .invalidFilter { background: $stFiltersInvalidFilter; }

  .filters .table div.explanation:hover {
    background: $stFiltersRowHoverBackground;
  }

  .filters .table div.explanation:hover > span {
    background: none;
  }

  .filters .filterBeingEdited {
    outline: 2px dashed #080;
  }

  .table .explanation span {
    display: inline;
    padding: 2px 5px;
    margin: 0;
    pointer-events: none;
  }

  .table span.column {
    font-weight: bold;
  }

  .table span.op {
    font-weight: bold;
    color: $stFiltersOperator;
  }

  .table span.value {
    color: $stFiltersValue;
  }

  .table button.new {
    margin-top: 5px;
  }

  .table span.notification {
    flex-grow: 2;
    text-align: right;
    font-style: italic;
  }

  /* Mass tools */
  .mass .mainButtons {
  }

  .mass .controls {
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
  }

  .mass .controls > * {
    display: inline-block;
    margin-right: 5px;
  }

  .mass .controls progress {
    min-width: 250px;
  }

  .mass .controls .counter {
    font-weight: bold;
    font-size: 100%;
  }

  .mass fieldset {
    border: none;
    border-top: 1px solid $formFieldsetBorderColor;
    padding: 10px 0;
    margin: 0;
  }

  .mass fieldset legend {
    margin-left: 10px;
    padding: 0 5px;
  }

  .mass .ui {
    padding: 0;
    margin: 0;
  }

  .mass .ui fieldset {
    border: 1px solid $formFieldsetBorderColor;
  }

  .mass .ui .mobileTitle {
    display: none;
  }

  @media #{$screen-breakpoint-one} {
    .mobileTitle {
      display: block;
      font-weight: bold;
    }
  }

  /* The status box */
  .status {
    border: 1px solid $stStatusBorder;
    padding: 5px;
  }

  /* Mass processing status success/fail counters */
  .status .success { background: $stStatusSuccess; }
  .status .fail { background: $stStatusFail; }

  /* The update error message */
  .error {
    background: $stErrorBackground;
    color: $stErrorForeground;
    border: 1px solid $stErrorBorder;
    padding: 5px;
    border-radius: 3px;
  }

  /* The supertable itself */
  .table {
    border-collapse: collapse;
    width: 100%;
  }

  .table td, .table th {
    border: 1px solid $stTableBorder;
    padding: 5px;
  }

  .table th {
    text-align: left;
    background: $stTableHeaderBackground;
    padding: 10px;
    color: $stTableHeaderForeground;
  }

  .table th.sortable:hover {
    background: $stTableHeaderHoverBackground;
  }

  /* Supertable sort header cells */
  .table th div {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    pointer-events: none;
  }

  .table th div span {
    display: inline;
  }

  .table th div span.arrow {
    margin-left: auto;
    font-family: puavo-icons;
    font-size: 100%;
    font-weight: normal;
    padding-left: 5px;
  }

  .table th.sorted {
    background: $stTableHeaderHoverBackground;
  }

  .table tbody tr:hover {
    background: $stTableRowHoverBackground;
  }

  .table .sorted { background: $stTableSortedColumnBackground; }

  .table tbody tr { background: $pageContentBack; }

  .table tbody tr.success { background: $stTableSuccessRowBackground; }
  .table tbody tr.success:hover { background: $stTableSuccessRowHoverBackground !important; }
  .table tbody tr.success .sorted { background: $stTableSuccessRowSortedBackground; }
  .table tbody tr.success:hover .sorted { background: $stTableSuccessRowHoverSortedBackground !important; }

  .table tbody tr.fail { background: $stTableFailRowBackground; }
  .table tbody tr.fail:hover { background: $stTableFailRowHoverBackground !important; }
  .table tbody tr.fail .sorted { background: $stTableFailRowSortedBackground; }
  .table tbody tr.fail:hover .sorted { background: $stTableFailRowHoverSortedBackground !important; }

  .table tbody tr:hover .sorted {
    background: $stTableSortedColumnHoverBackground;
  }

  .table .previousRow {
    outline: 2px dotted $stTablePreviousRowBorder;
  }

  /* Row checkboxes */
  .table .checkbox {
    /* Prevent text/table cell selections during range selections */
    user-select: none;
  }

  .table .checkbox span {
    border: 1px solid $stTableBorder;
    display: block;
    width: 20px;
    height: 20px;
    background: $stTableCheckboxColumnBack;
    background-repeat: no-repeat;
    background-position: 50% 50%;
    pointer-events: none;
  }

  .table .checkbox span.checked {
    background-image: url("<%= image_path('cross.svg') %>");
    background-color: $stTableCheckboxColumnBack;
    background-size: 80%;
  }

  .table .updating {
    opacity: 0.5;
  }
}

.filterPopup {
  display: none;    /* changed to "flex" when displaying the popup */
  border: 2px solid $stFiltersPopupBorder;
  padding: 0;
  margin: 0;
  min-width: 500px;
  max-width: 500px;
  flex-direction: column;
  flex-wrap: nowrap;
  background: $stFiltersPopupBackground;
  box-shadow: 0 0 10px $stFiltersPopupShadow;
}

.filterPopup .upper {
  display: flex;
  background: $stFiltersPopupHeaderBackground;
  border-bottom: 1px solid $stFiltersPopupHeaderBorder;
  align-items: center;
}

.filterPopup .upper > div {
  display: inline;
  padding: 5px;
}

.filterPopup .upper .title {
  font-size: 90%;
  font-weight: bold;
}

.filterPopup .upper .buttons {
  display: flex;
  flex-grow: 2;
  justify-content: flex-end;
}

.filterPopup .upper .buttons > button {
  padding: 0 15px;
  font-size: 90%;
  margin-left: 5px;
}

.filterPopup .btn-save { color: #080; }
.filterPopup .btn-cancel { color: #800; }

.filterPopup .lower {
  font-size: 75%;
}

.filterPopup .lower th {
}

.filterPopup .lower p {
  margin: 0;
  padding: 0;
}

.filterPopup select {
  width: 100%;
  font-size: 100%;
  padding: 2px;
}

/* Supertable cell header drag item */
div.dragHeader {
  position: absolute;
  display: flex;
  align-items: center;
  border: 1px solid $stTableBorder;
  padding: 5px;
  margin: 0;
  font-weight: bold;
  background: $stTableHeaderHoverBackground;
  color: $stTableHeaderForeground;
  z-index: 10;
  font-size: 90%;
  cursor: grabbing;
  user-select: none;
  box-shadow: 0 0 5px $stTableDragHeaderShadow;
}

/* Supertable drop target position indicator */
div.dropMarker {
  position: absolute;
  display: block;
  border: none;
  background: $stTableDragHeaderMarker;
  z-index: 9;
}
